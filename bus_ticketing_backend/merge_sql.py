import os

def merge_sql():
    full_import_path = r'c:\manikanta chary\my_app\bus_ticketing_backend\full_data_import.sql'
    data_sql_path = r'c:\manikanta chary\my_app\bus_ticketing_backend\src\main\resources\data.sql'
    
    with open(full_import_path, 'r', encoding='utf-8') as f:
        full_import_content = f.read()
    
    # Buses data and sequence resets
    buses_sql = """
INSERT INTO buses (id, bus_number, route, capacity, available_seats, current_location, rating, price, route_stops_order) VALUES
(1, 'TS09UB1234', '10H', 40, 25, 'Secunderabad', 4.5, 25.0, '1574,301,302,303,304,323'),
(2, 'TS09UB5678', '222A', 40, 15, 'Koti', 4.2, 35.0, '348,301,302,303,304,4003,4002'),
(3, 'TS09UB9012', '113M/W', 40, 30, 'Uppal', 4.8, 40.0, '937,932,929,924,804,4002'),
(4, 'TS09UB3456', '17H/10H', 40, 10, 'ECIL', 4.0, 30.0, '1065,813,1574,304,323'),
(5, 'TS09UB7890', '218L', 40, 20, 'Lingampally', 4.3, 35.0, '398,4002,4003,4005,4006,4007,348,4001'),
(6, 'TS09UB2468', '10H', 45, 12, 'Kondapur', 4.6, 25.0, '323,322,321,320,319,1574'),
(7, 'TS09UB1357', '222A', 42, 28, 'Patancheru', 4.1, 35.0, '4002,4003,304,348'),
(8, 'TS09UB8642', '113M/K', 38, 5, 'Uppal', 4.7, 45.0, '937,929,887,447,804'),
(9, 'TS09UB9753', '10H/W', 40, 35, 'Waverock', 4.4, 30.0, '1056,915,911,323,1574'),
(10, 'TS09UB5432', '1C', 50, 45, 'CBS', 3.9, 15.0, '1438,749,1583,1574'),
(11, 'TS09UB0987', '218L', 40, 18, 'Dilsukhnagar', 4.2, 35.0, '4001,348,4007,4006,4005,4004,4003,4002,398'),
(12, 'TS09UB6789', '113M/W', 40, 22, 'Wave Rock', 4.5, 40.0, '1056,915,804,803,802,937'),
(13, 'TS09UB1122', '10H/17H', 40, 8, 'Kondapur', 4.3, 30.0, '323,319,318,1574,1065'),
(14, 'TS09UB3344', '17H/10H', 40, 30, 'Waverock', 4.6, 30.0, '1056,323,304,1574,1065'),
(15, 'TS09UB5566', '10H/W', 40, 15, 'Secunderabad', 4.4, 30.0, '1574,304,323,911,1056'),
(16, 'TS09UB1111', '127K', 40, 20, 'Koti', 4.5, 25.0, '348,301,302,303,304,352,306,308,311,334,321,323'),
(17, 'TS09UB2222', '127K', 40, 15, 'Kondapur', 4.3, 25.0, '323,321,334,311,308,306,352,304,303,302,301,348'),
(18, 'TS09UB3333', '90L', 40, 25, 'JBS', 4.4, 30.0, '1040,2105,813,1574,1208,1214,888,956,447,924,929,937,959'),
(19, 'TS09UB4444', '90L', 40, 10, 'LB Nagar', 4.2, 30.0, '959,937,929,924,447,956,888,1214,1208,1574,813,2105,1040'),
(20, 'TS09UB5555', '5K', 40, 30, 'Mehdipatnam', 4.6, 20.0, '804,803,802,306,305,304,303,302,301,348,1574'),
(21, 'TS09UB6666', '5K', 40, 5, 'Secunderabad', 4.7, 20.0, '1574,348,301,302,303,304,305,306,802,803,804'),
(22, 'TS09UB7777', '218L', 40, 12, 'Lingampally', 4.5, 35.0, '398,908,1061,909,910,1064,911,913,915,916,917,918,919,1067,920,802,803,1065,804,816,817,352,492,344,883,884,885,888,956,447,924,887,929,930,931,932,933,934,935,936,937,4001'),
(23, 'TS09UB8888', '10H', 40, 35, 'Secunderabad', 4.4, 25.0, '1574,813,2105,1040,1208,1214,368,927,1402,1329,448,1568,1466,1403,1580,749,1583,1404,1894,1406,1407,1408,1409,1410,1431,323'),
(24, 'TS09UB9999', '1C', 40, 40, 'CBS', 4.1, 15.0, '1438,749,1580,1403,1466,1568,448,1329,1402,927,368,1214,1209,1208,1401,1400,1399,1398,1574'),
(25, 'TS09UB0000', '127KL', 40, 22, 'LB Nagar', 4.5, 45.0, '959,937,932,929,887,924,447,956,888,885,884,883,344,492,352,304,303,302,301,348,323'),
(26, 'TS09UB1212', '222A', 40, 18, 'Koti', 4.4, 35.0, '348,301,302,303,304,352,492,344,883,884,885,888,956,447,924,929,937,4001,4002,4003,4004,4005,4006,4007'),
(27, 'TS09UB3434', '113M/W', 40, 25, 'Uppal', 4.3, 40.0, '937,936,935,934,933,932,931,930,929,887,924,447,956,888,885,884,883,344,492,352,817,816,804,1065,803,802,920,1067,919,918,917,916,915,913,911,1064,910,909,1061,908,906,398'),
(28, 'TS09UB5656', '10H', 40, 30, 'Secunderabad', 4.5, 25.0, '1574,1398,1399,1400,1401,1208,1209,1214,368,927,1402,1329,448,956,888,885,884,883,344,492,352,817,816,804,1065,803,802,920,1067,919,918,917,916,915,913,911,1064,910,909,1061,908,906,398,323'),
(29, 'TS09UB7878', '90L', 40, 15, 'JBS', 4.2, 30.0, '1040,2105,813,1574,1398,1399,1400,1401,1208,1209,1214,368,927,1402,1329,448,956,888,885,884,883,344,492,352,817,816,804,1065,803,802,920,1067,919,918,917,916,915,913,911,1064,910,909,1061,908,906,398,959'),
(30, 'TS09UB9090', '218L', 40, 10, 'Lingampally', 4.6, 35.0, '398,906,908,1061,909,910,1064,911,913,915,916,917,918,919,1067,920,802,803,1065,804,816,817,352,492,344,883,884,885,888,956,447,924,887,929,930,931,932,933,934,935,936,937,4001') ON CONFLICT (id) DO NOTHING;

-- Reset sequences for PostgreSQL IDENTITY columns after manual ID insertion
SELECT setval(pg_get_serial_sequence('routes', 'id'), coalesce(max(id), 1)) FROM routes;
SELECT setval(pg_get_serial_sequence('bus_stops', 'id'), coalesce(max(id), 1)) FROM bus_stops;
SELECT setval(pg_get_serial_sequence('buses', 'id'), coalesce(max(id), 1)) FROM buses;
"""
    
    with open(data_sql_path, 'w', encoding='utf-8') as f:
        f.write(full_import_content)
        f.write("\n")
        f.write(buses_sql)

if __name__ == "__main__":
    merge_sql()
